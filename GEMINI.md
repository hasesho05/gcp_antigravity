# GCP認定資格プラットフォーム 開発ガイドライン (GEMINI.md)

このドキュメントは、GCP認定資格模擬試験プラットフォームの開発におけるプロジェクトの概要、開発プロセス、およびGitHub運用規範を定めたものです。

## 1. プロジェクト概要

このプロジェクトは、GoとFirestoreを使用して、GCP認定資格の模擬試験を提供するバックエンドAPIを開発することを目的としています。

- **プロジェクト名:** GCP認定資格プラットフォーム (Antigravity Backend)
- **技術スタック:** Go (Cloud Run), Firebase Firestore, Chi Router
- **リポジトリURL:** [開発開始時に設定]

コードベースはGitHubで管理し、すべての開発タスクはGitHubのIssueを起点とします。

## 2. GitHub運用規範

すべてのGitHub操作（Issue作成、ブランチ作成、プルリクエスト作成など）は、MCP（Gemini）を通じて行います。 開発者が直接Web UIやGitコマンドで操作することは原則として禁止します。これにより、開発プロセスの一貫性、進捗の可視性、そして成果物のトレーサビリティを確保します。

## 3. 開発ワークフロー

当プロジェクトの開発は、すべてGitHub Issueを起点として進行します。コード変更を伴ういかなる作業も、必ずIssueを作成してから開始してください。

### Step 1: Issueの作成

すべての開発作業（機能追加、バグ修正、リファクタリング、ドメインモデルの変更等）は、まずGitHub Issueを作成することから始めます。

- **目的:** 開発タスクの要件、背景、ゴールを明確に定義します。
- **記載事項:**
    - **Title:** タスク内容を簡潔に表現してください。(例: `feat: ユーザーの受験開始APIエンドポイントを実装する`)
    - **Body:**
        - **背景 (Background):** なぜこのIssueが必要なのか、どのような課題を解決するのかを記述します。
        - **要件 (Requirements):** 実装すべき機能の仕様を箇条書きで具体的に記述します。
            - 例: `POST /users/me/attempts` エンドポイントで、認証済みユーザーIDとリクエストボディに基づき、Attempt エンティティを作成しFirestoreに保存する。
        - **前提事項 (Prerequisites):** このタスクに着手するための条件や、依存する他のIssueがあれば記述します。（例: `#10 UsecaseのDIが完了していること`）
        - **テストケース (Test Cases):** 実装が完了したことを確認するための具体的なテストシナリオを記述します。成功ケースと失敗ケースの両方を想定してください。（例: 有効なトークンとリクエストで`201 Created`が返ること、無効な`ExamID`で`400 Bad Request`が返ること）

### Step 2: ブランチの作成

Issueを作成後、そのIssueに対応する作業ブランチを作成します。

- **ブランチ命名規則:** `feature/issue-<issue番号>` または `fix/issue-<issue番号>`
- **例:** Issue番号が`#25`の場合、ブランチ名は `feature/issue-25` となります。

### Step 3: 実装とテスト

作成したブランチ上で、Issueに定義された要件に基づき実装を行います。

- **ディレクトリ規約の厳守:** `internal/domain`、`internal/usecase`、`internal/repository_impl` などの層を分離したクリーンアーキテクチャの原則に従うこと。
- **エラーハンドリング:** `github.com/cockroachdb/errors` を利用し、`errors.Wrap()` でスタックトレースを維持すること。

実装完了後、Issueに記載されたテストケースをすべて実施し、期待通りに動作することを確認してください。新しいコードには、可能な限りユニットテストを追加してください。

### Step 4: プルリクエストの作成

実装とテストが完了したら、`main`ブランチ（または開発用の`develop`ブランチ）に対してプルリクエストを作成します。

- **タイトル:** `[#<issue番号>] <Issueのタイトル>` の形式で記述します。
- **本文:**
    - `Closes #<issue番号>` を記載し、マージ時に自動でIssueが閉じるように設定します。
    - 実装内容の概要や、レビューしてほしい点を記述します。

### Step 5: コードレビューとマージ

作成されたプルリクエストは、チームメンバーによるコードレビューを受けます。レビューでの指摘事項を修正し、承認（Approve）されたら、プルリクエストをマージします。

## 4. コミットメッセージ規約

### Type

コミットの接頭辞として、以下のいずれかを指定します。

- `feat`: 新機能 (A-201, C-301など)
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: フォーマット、セミコロンなど（ロジック変更なし）
- `refactor`: リファクタリング（機能変更なし）
- `test`: テストの追加・修正
- `chore`: ビルドプロセス、依存関係の更新など

### Subject & Body

- **subject:** 変更内容の要約を50文字以内で記述します。
- **body:** (任意)変更の具体的な理由や詳細を記述します。

### 例

```
feat: [#C-304] GET /users/me/stats/{examID} エンドポイントを実装

- ChiのURLParamを使用してexamIDを取得
- Usecaseでnilが返された場合に404を返すロジックを実装
```
